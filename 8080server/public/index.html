<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
    <title>Sumire's Portforio</title>
  </head>
  <body>
    <h1>Sumire's Portforio</h1>
    <div class="introduce">
      <div class="image">
        <a href="https://ibb.co/BtGJZ1Z"
          ><img
            src="https://i.ibb.co/BtGJZ1Z/message-Image-1673003528381.jpg"
            alt="message-Image-1673003528381"
            border="0"
        /></a>
      </div>
      <div class="contents">
        <h3>Name</h3>
        <p>Sumire Inoue</p>
        <h3>Age</h3>
        <p>19</p>
        <h3>Skill</h3>
        <p>HTML,CSS,JavaScript,React</p>
      </div>
    </div>
    <div class="Works">
      <h3>Pixer API</h3>
      <input name="key" type="text" placeholder="文字を入力してください" />
      <input name="btn" type="submit" onclick="renderImage()" value="ボタン" />
      <div id="result"></div>
      <script>
        const renderImage = () => {
          const key = document.getElementsByName("key");
          const value = key[0].value;
          console.log(value);

          fetch(createURL(value))
            .then(function(data) {
              return data.json(); //JSONデータとして取得する
            })
            .then(function(json) {
              createImage(json);
            });
        };

        //リクエスト用のURLを生成する
        const createURL = value => {
          var API_KEY = "32554373-1a74765540dc94a643f6729ea";
          var baseUrl = "https://pixabay.com/api/?key=" + API_KEY;
          var keyword = "&q=" + encodeURIComponent(value);
          var option = "&orientation=horizontal&per_page=40";
          var URL = baseUrl + keyword + option;
          return URL;
        };
        //画像のJSONデータを画面に表示する
        const createImage = json => {
          var result = document.getElementById("result");
          result.innerHTML = ""; //検索するごとに画面をリセットする
          //該当する画像があれば
          if (json.totalHits > 0) {
            json.hits.forEach(function(value) {
              var img = document.createElement("img");
              var a = document.createElement("a");
              a.href = value.pageURL; //ダウンロード用のサイトURL
              a.target = "_blank";
              img.src = value.previewURL; //プレビュー用の画像URL
              a.appendChild(img);
              result.appendChild(a);
            });
          } else {
            alert("該当する写真がありません");
          }
        };
      </script>
    </div>
  </body>
</html>
